simple text processor

Rules:
1) comment starts with
2) definition contains '=', and not an empty name
3) variable substitution is denoted by the '$'

Example

INPUT:
# this is a comment
PATH=/usr/bin
$PATH/gcc prog.c -o prog

OUTPUT:
/usr/bin/gcc prog.c -o prog